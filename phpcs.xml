<?xml version="1.0"?>
<ruleset name="phpUploader Coding Standard">
    <description>Coding standard for phpUploader project</description>

    <!-- 対象ファイル -->
    <file>.</file>

    <!-- 除外パス -->
    <exclude-pattern>vendor/*</exclude-pattern>
    <exclude-pattern>tests/*</exclude-pattern>
    <exclude-pattern>docker/*</exclude-pattern>
    <exclude-pattern>data/*</exclude-pattern>
    <exclude-pattern>db/*</exclude-pattern>
    <exclude-pattern>logs/*</exclude-pattern>
    <exclude-pattern>.vscode/*</exclude-pattern>

    <!-- 基本規則 -->
    <rule ref="PSR12">
        <!-- Ver.2.0 では名前空間を使用していないため一時的に無視 -->
        <exclude name="PSR1.Classes.ClassDeclaration.MissingNamespace"/>
        <!-- ファイルヘッダーの順序は柔軟に対応 -->
        <exclude name="PSR12.Files.FileHeader.IncorrectOrder"/>
        <!-- 一行の長さ制限を緩和 (HTMLとSQLが含まれるため) -->
        <exclude name="Generic.Files.LineLength.TooLong"/>
    </rule>

    <!-- ファイルエンコーディング -->
    <rule ref="Generic.Files.ByteOrderMark"/>

    <!-- セキュリティ関連 -->
    <rule ref="Generic.PHP.DisallowShortOpenTag"/>
    <rule ref="Generic.PHP.DisallowAlternativePHPTags"/>

    <!-- コード品質 -->
    <rule ref="Generic.PHP.ForbiddenFunctions">
        <properties>
            <property name="forbiddenFunctions" type="array">
                <element key="eval" value="null"/>
                <element key="create_function" value="null"/>
                <element key="var_dump" value="null"/>
                <element key="print_r" value="null"/>
            </property>
        </properties>
    </rule>

    <!-- Ver.2.0 特定ファイルの例外設定 -->
    <!-- スクリプトファイルはサイドエフェクトが必要なため例外扱い -->
    <rule ref="PSR1.Files.SideEffects">
        <exclude-pattern>scripts/*</exclude-pattern>
        <exclude-pattern>app/models/init.php</exclude-pattern>
    </rule>

    <!-- 設定 -->
    <ini name="memory_limit" value="256M"/>

    <!-- 警告を表示 -->
    <config name="show_warnings" value="1"/>
</ruleset>
